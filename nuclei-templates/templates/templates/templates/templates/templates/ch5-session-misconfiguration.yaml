id: ch5-session-misconfiguration

info:
  name: Session Misconfiguration Detection
  author: security-researcher
  severity: medium
  description: |
    The application has session management misconfiguration issues.
    Session tokens may be predictable, reusable, or improperly validated.
  tags: session,misconfiguration,cookie

http:
  - method: GET
    path:
      - "{{BaseURL}}/"
      - "{{BaseURL}}/login"
      - "{{BaseURL}}/dashboard"
      - "{{BaseURL}}/admin"
      - "{{BaseURL}}/user"
      - "{{BaseURL}}/profile"
      - "{{BaseURL}}/init"
      - "{{BaseURL}}/start"

    stop-at-first-match: false
    
    matchers-condition: or
    matchers:
      - type: word
        part: header
        words:
          - "Set-Cookie"

      - type: status
        status:
          - 200
          - 302
          - 301

  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        Cookie: session=admin; role=admin; user=admin; authenticated=true

      - |
        GET /admin HTTP/1.1
        Host: {{Hostname}}
        Cookie: isAdmin=1; privilege=admin

      - |
        GET /dashboard HTTP/1.1
        Host: {{Hostname}}
        Cookie: user_type=admin; access_level=9

    matchers-condition: or
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "admin"
          - "dashboard"
          - "authenticated"
          - "welcome"
          - "success"
        condition: or
